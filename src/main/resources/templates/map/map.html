<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>추천 장소 지도</title>

    <!-- 네이버 지도 API 스크립트 -->
    <script type="text/javascript" src="https://openapi.naver.com/openapi/v3/maps.js?clientId=YOUR_CLIENT_ID"></script>

    <script>
        let map;
        let markers = [];

        // 네이버 지도 초기화
        function initMap() {
            map = new naver.maps.Map('map', {
                center: new naver.maps.LatLng(37.5665, 126.9780), // 서울 시청 위치
                zoom: 13
            });
        }

        // 장소 추천 후 지도에 마커 표시
        function displayRecommendations(recommendations) {
            // 기존 마커가 있으면 모두 제거
            markers.forEach(marker => marker.setMap(null));
            markers = [];

            recommendations.forEach(place => {
                const marker = new naver.maps.Marker({
                    position: new naver.maps.LatLng(place.lat, place.lng),
                    map: map,
                    title: place.name
                });

                const infoWindow = new naver.maps.InfoWindow({
                    content: `<h3>${place.name}</h3>`
                });

                naver.maps.Event.addListener(marker, 'click', function() {
                    infoWindow.open(map, marker);
                });

                markers.push(marker);
                map.setCenter(new naver.maps.LatLng(place.lat, place.lng));  // 지도 중심 이동
                map.setZoom(15);  // 줌 레벨
            });
        }

        // 서버로부터 추천 장소 데이터를 AJAX로 받아오기
        function fetchRecommendations() {
            const category = document.getElementById('category').value;
            const location = document.getElementById('location').value;

            // AJAX로 서버에 요청
            fetch(`/map/recommendations?category=${category}&location=${location}`)
                .then(response => response.json())
                .then(data => {
                    displayRecommendations(data);
                })
                .catch(error => console.error('Error fetching recommendations:', error));
        }
    </script>
</head>
<body onload="initMap()">
    <h1>추천 장소</h1>

    <label for="category">장소 카테고리:</label>
    <select id="category">
        <option value="food">음식</option>
        <option value="tourist">관광지</option>
        <option value="coffee">카페</option>
    </select>

    <label for="location">위치 (예: 서울, 강남 등):</label>
    <input type="text" id="location" placeholder="예: 서울">

    <button onclick="fetchRecommendations()">추천 장소 가져오기</button>

    <div id="map" style="width: 100%; height: 600px;"></div>
</body>
</html>

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>여행지 추천</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center">AI 추천</h1>
        
        <!-- 설문조사 폼 -->
        <div id="surveyFormContainer" class="mt-4">
            <h3>여행 설문조사</h3>
            <form id="surveyForm">
                <!-- 나이 체크 -->
                <div class="form-group">
                    <label>나이</label>
                    <div>
                        <label><input type="radio" name="age" value="10대" required> 10대</label>
                        <label><input type="radio" name="age" value="20대" required> 20대</label>
                        <label><input type="radio" name="age" value="30대" required> 30대</label>
                        <label><input type="radio" name="age" value="40대" required> 40대</label>
                        <label><input type="radio" name="age" value="50대 이상" required> 50대 이상</label>
                    </div>
                </div>

                <!-- 지역 선택 -->
                <div class="form-group">
                    <label for="region">지역</label>
                    <select class="form-control" id="region" required>
                        <option value="">지역을 선택하세요</option>
                        <option value="서울">서울</option>
                        <option value="부산">부산</option>
                        <option value="대구">대구</option>
                        <option value="광주">광주</option>
                        <option value="인천">인천</option>
                        <option value="대전">대전</option>
                        <option value="울산">울산</option>
                        <option value="세종">세종</option>
                        <option value="경기">경기</option>
                        <option value="강원">강원</option>
                        <option value="충남">충남</option>
                        <option value="충북">충북</option>
                        <option value="전남">전남</option>
                        <option value="전북">전북</option>
                        <option value="경남">경남</option>
                        <option value="경북">경북</option>
                        <option value="제주">제주</option>
                    </select>
                </div>

                <!-- 여행 인원 체크 -->
                <div class="form-group">
                    <label>여행 인원</label>
                    <div>
                        <label><input type="radio" name="travelers" value="1명" required> 1명</label>
                        <label><input type="radio" name="travelers" value="2명" required> 2명</label>
                        <label><input type="radio" name="travelers" value="2명 이상" required> 2명 이상</label>
                        <label><input type="radio" name="travelers" value="4명 이상" required> 4명 이상</label>
                    </div>
                </div>

                <!-- 예산 체크 -->
                <div class="form-group">
                    <label>예산</label>
                    <div>
                        <label><input type="radio" name="budget" value="10만원 이하" required> 10만원 이하</label>
                        <label><input type="radio" name="budget" value="10만원~20만원" required> 10만원~20만원</label>
                        <label><input type="radio" name="budget" value="20만원~50만원" required> 20만원~50만원</label>
                        <label><input type="radio" name="budget" value="50만원~100만원" required> 50만원~100만원</label>
                        <label><input type="radio" name="budget" value="100만원 이상" required> 100만원 이상</label>
                    </div>
                </div>

                <!-- 취향 선택 -->
                <div class="form-group">
                    <label for="preference">여행 취향</label>
                    <select class="form-control" id="preference" required>
                        <option value="">취향을 선택하세요</option>
                        <option value="휴식">휴식</option>
                        <option value="문화">문화</option>
                        <option value="자연탐방">자연탐방</option>
                        <option value="미식여행">미식여행</option>
                        <option value="액티비티">액티비티</option>
                        <option value="쇼핑/도시탐방">쇼핑/도시탐방</option>
                    </select>
                </div>

                <!-- 이동 수단 -->
                <div class="form-group">
                    <label for="transportation">이동 수단</label>
                    <select class="form-control" id="transportation" required>
                        <option value="">이동 수단을 선택하세요</option>
                        <option value="자차">자차</option>
                        <option value="기차">기차</option>
                        <option value="비행기">비행기</option>
                    </select>
                </div>

                <!-- 제출 버튼 -->
                <button type="submit" class="btn btn-primary">제출</button>
            </form>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.getElementById("surveyForm").addEventListener("submit", function(event) {
            event.preventDefault();  // 기본 폼 제출 방지

            // 각 입력값 가져오기
            const age = document.querySelector('input[name="age"]:checked') ? document.querySelector('input[name="age"]:checked').value : '';
            const region = document.getElementById("region").value;
            const travelers = document.querySelector('input[name="travelers"]:checked') ? document.querySelector('input[name="travelers"]:checked').value : '';
            const budget = document.querySelector('input[name="budget"]:checked') ? document.querySelector('input[name="budget"]:checked').value : '';
            const preference = document.getElementById("preference").value;
            const transportation = document.getElementById("transportation").value;

            // 필수 항목 체크
            if (!age || !region || !travelers || !budget || !preference || !transportation) {
                alert("모든 항목을 채워주세요!");
                return;
            }

            // 설문 데이터 객체로 정리
            const surveyData = {
                age,
                region,
                travelers,
                budget,
                preference,
                transportation
            };
            console.log("설문 응답 데이터:", surveyData);

            // 서버로 설문 데이터 전송
            fetch('/submit-survey', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(surveyData)
            })
            .then(response => response.text())
            .then(data => {
                alert(data);  // 서버의 응답 메시지 출력
                window.location.href = "/";  // 홈 페이지로 리디렉션
            })
            .catch(error => {
                console.error('설문 제출 실패:', error);
                alert("설문 제출에 실패했습니다. 다시 시도해주세요.");
            });
        });
    </script>
</body>
</html>
